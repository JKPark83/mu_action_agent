"""주소 → 법정동코드(5자리) 변환 유틸리티"""

from __future__ import annotations

# 서울특별시 자치구
_SEOUL = {
    "서울특별시 종로구": "11110",
    "서울특별시 중구": "11140",
    "서울특별시 용산구": "11170",
    "서울특별시 성동구": "11200",
    "서울특별시 광진구": "11215",
    "서울특별시 동대문구": "11230",
    "서울특별시 중랑구": "11260",
    "서울특별시 성북구": "11290",
    "서울특별시 강북구": "11305",
    "서울특별시 도봉구": "11320",
    "서울특별시 노원구": "11350",
    "서울특별시 은평구": "11380",
    "서울특별시 서대문구": "11410",
    "서울특별시 마포구": "11440",
    "서울특별시 양천구": "11470",
    "서울특별시 강서구": "11500",
    "서울특별시 구로구": "11530",
    "서울특별시 금천구": "11545",
    "서울특별시 영등포구": "11560",
    "서울특별시 동작구": "11590",
    "서울특별시 관악구": "11620",
    "서울특별시 서초구": "11650",
    "서울특별시 강남구": "11680",
    "서울특별시 송파구": "11710",
    "서울특별시 강동구": "11740",
}

# 경기도 주요 시·구
_GYEONGGI = {
    "경기도 수원시 장안구": "41111",
    "경기도 수원시 권선구": "41113",
    "경기도 수원시 팔달구": "41115",
    "경기도 수원시 영통구": "41117",
    "경기도 성남시 수정구": "41131",
    "경기도 성남시 중원구": "41133",
    "경기도 성남시 분당구": "41135",
    "경기도 의정부시": "41150",
    "경기도 안양시 만안구": "41171",
    "경기도 안양시 동안구": "41173",
    "경기도 부천시": "41190",
    "경기도 광명시": "41210",
    "경기도 평택시": "41220",
    "경기도 동두천시": "41250",
    "경기도 안산시 상록구": "41271",
    "경기도 안산시 단원구": "41273",
    "경기도 고양시 덕양구": "41281",
    "경기도 고양시 일산동구": "41285",
    "경기도 고양시 일산서구": "41287",
    "경기도 과천시": "41290",
    "경기도 구리시": "41310",
    "경기도 남양주시": "41360",
    "경기도 오산시": "41370",
    "경기도 시흥시": "41390",
    "경기도 군포시": "41410",
    "경기도 의왕시": "41430",
    "경기도 하남시": "41450",
    "경기도 용인시 처인구": "41461",
    "경기도 용인시 기흥구": "41463",
    "경기도 용인시 수지구": "41465",
    "경기도 파주시": "41480",
    "경기도 이천시": "41500",
    "경기도 안성시": "41550",
    "경기도 김포시": "41570",
    "경기도 화성시": "41590",
    "경기도 광주시": "41610",
    "경기도 양주시": "41630",
    "경기도 포천시": "41650",
}

# 광역시
_METRO = {
    "부산광역시 중구": "26110",
    "부산광역시 서구": "26140",
    "부산광역시 동구": "26170",
    "부산광역시 영도구": "26200",
    "부산광역시 부산진구": "26230",
    "부산광역시 동래구": "26260",
    "부산광역시 남구": "26290",
    "부산광역시 북구": "26320",
    "부산광역시 해운대구": "26350",
    "부산광역시 사하구": "26380",
    "부산광역시 금정구": "26410",
    "부산광역시 강서구": "26440",
    "부산광역시 연제구": "26470",
    "부산광역시 수영구": "26500",
    "부산광역시 사상구": "26530",
    "부산광역시 기장군": "26710",
    "대구광역시 중구": "27110",
    "대구광역시 동구": "27140",
    "대구광역시 서구": "27170",
    "대구광역시 남구": "27200",
    "대구광역시 북구": "27230",
    "대구광역시 수성구": "27260",
    "대구광역시 달서구": "27290",
    "대구광역시 달성군": "27710",
    "인천광역시 중구": "28110",
    "인천광역시 동구": "28140",
    "인천광역시 미추홀구": "28177",
    "인천광역시 연수구": "28185",
    "인천광역시 남동구": "28200",
    "인천광역시 부평구": "28237",
    "인천광역시 계양구": "28245",
    "인천광역시 서구": "28260",
    "광주광역시 동구": "29110",
    "광주광역시 서구": "29140",
    "광주광역시 남구": "29155",
    "광주광역시 북구": "29170",
    "광주광역시 광산구": "29200",
    "대전광역시 동구": "30110",
    "대전광역시 중구": "30140",
    "대전광역시 서구": "30170",
    "대전광역시 유성구": "30200",
    "대전광역시 대덕구": "30230",
    "울산광역시 중구": "31110",
    "울산광역시 남구": "31140",
    "울산광역시 동구": "31170",
    "울산광역시 북구": "31200",
    "울산광역시 울주군": "31710",
    "세종특별자치시": "36110",
}

# 전체 매핑 (구 단위 매핑이 우선 매칭되도록 긴 키부터 정렬)
LAWD_CODE_MAP: dict[str, str] = {}
for _group in (_SEOUL, _GYEONGGI, _METRO):
    LAWD_CODE_MAP.update(_group)


def address_to_lawd_code(address: str) -> str | None:
    """주소 문자열에서 법정동코드 5자리를 추출한다.

    가장 긴 매칭(구 단위)을 우선으로 찾는다.

    Examples:
        >>> address_to_lawd_code("서울특별시 강남구 역삼동 123-45")
        '11680'
    """
    # 긴 이름부터 매칭 시도 (예: "서울특별시 강남구"가 "서울특별시"보다 우선)
    for name in sorted(LAWD_CODE_MAP, key=len, reverse=True):
        if name in address:
            return LAWD_CODE_MAP[name]
    return None
