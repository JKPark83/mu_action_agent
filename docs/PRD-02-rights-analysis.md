# PRD-02: 권리분석 에이전트 (Rights Analysis Agent)

> **문서 버전**: v1.0
> **작성일**: 2026-02-12
> **상태**: Draft
> **상위 문서**: PRD-00 시스템 개요
> **의존성**: PRD-01 (경매 문서 파싱)

---

## 1. 개요

### 1.1 목적
등기부등본과 매각물건명세서를 기반으로 경매 물건의 권리관계를 분석하고, 인수/소멸되는 권리를 판별하며, 위험요소를 식별하는 AI 에이전트를 개발한다.

### 1.2 배경
부동산 경매에서 권리분석은 가장 핵심적인 단계이다. 등기부등본의 갑구(소유권)와 을구(소유권 이외의 권리)를 분석하여 낙찰 후 인수해야 하는 권리와 소멸되는 권리를 정확히 구분해야 한다. 잘못된 권리분석은 큰 금전적 손실로 이어질 수 있다.

---

## 2. 핵심 분석 영역

### 2.1 말소기준권리 판단
- **최선순위 설정일자 확인**: 근저당, 전세권, 가압류, 담보가등기 중 가장 빠른 설정일자
- **말소기준권리 결정**: 경매신청 채권자의 권리와 비교하여 말소기준 확정
- **기준일 이후 권리 판별**: 말소기준권리 이후 설정된 권리는 소멸

### 2.2 인수되는 권리 분석
| 권리 유형 | 인수 조건 |
|-----------|-----------|
| **선순위 전세권** | 말소기준권리보다 앞서 설정된 전세권 |
| **대항력 있는 임차권** | 전입신고 + 확정일자가 말소기준권리보다 선순위 |
| **법정지상권** | 토지와 건물의 소유자가 달라진 경우 |
| **유치권** | 현장 점유 + 공사대금 채권 등 |
| **분묘기지권** | 토지 위의 분묘에 대한 권리 |
| **지역권** | 타인의 토지를 사용할 수 있는 권리 |

### 2.3 소멸되는 권리 분석
- 말소기준권리 이후의 근저당권
- 말소기준권리 이후의 전세권
- 가압류, 가처분 (말소기준 이후)
- 압류, 경매기입등기

### 2.4 특수 권리 분석
- **가처분**: 소유권이전등기청구권 가처분 등의 위험도 분석
- **가등기**: 소유권이전청구권 가등기의 위험도 분석
- **예고등기**: 관련 소송의 위험도 분석
- **신탁등기**: 신탁 관련 특수 상황 분석

---

## 3. 기능 요구사항

### 3.1 권리관계 분석
- **FR-02-001**: 등기부등본의 갑구/을구를 파싱하여 모든 권리를 시간순으로 정렬해야 한다
- **FR-02-002**: 말소기준권리를 자동으로 판단해야 한다
- **FR-02-003**: 각 권리의 인수/소멸 여부를 판단해야 한다
- **FR-02-004**: 임차인의 대항력 유무를 판단해야 한다

### 3.2 위험도 평가
- **FR-02-005**: 경매 물건의 전체적인 위험도를 등급(상/중/하)으로 산정해야 한다
- **FR-02-006**: 개별 위험요소별 상세 설명을 제공해야 한다
- **FR-02-007**: 인수해야 할 금액의 총액을 산출해야 한다
- **FR-02-008**: 권리분석 결과에 대한 신뢰도를 제공해야 한다

### 3.3 임차인 분석
- **FR-02-009**: 매각물건명세서의 점유관계를 기반으로 임차인을 분석해야 한다
- **FR-02-010**: 각 임차인의 대항력, 우선변제권 유무를 판단해야 한다
- **FR-02-011**: 배당 순서를 예측하여 임차인이 보증금을 돌려받을 수 있는지 분석해야 한다
- **FR-02-012**: 명도 난이도를 예측해야 한다

### 3.4 결과 리포트
- **FR-02-013**: 권리분석 결과를 구조화된 리포트로 제공해야 한다
- **FR-02-014**: 비전문가도 이해할 수 있는 쉬운 용어로 설명해야 한다
- **FR-02-015**: 주의사항 및 추가 확인 필요 사항을 명시해야 한다

---

## 4. 데이터 모델

### 4.1 권리분석 결과 스키마
```python
@dataclass
class RightsAnalysisResult:
    """권리분석 결과"""
    case_number: str                    # 사건번호

    # 말소기준권리
    extinguishment_basis: ExtinguishmentBasis

    # 권리 목록
    all_rights: list[AnalyzedRight]     # 전체 분석된 권리
    assumed_rights: list[AnalyzedRight] # 인수되는 권리
    extinguished_rights: list[AnalyzedRight]  # 소멸되는 권리

    # 임차인 분석
    tenants: list[TenantAnalysis]

    # 위험도 평가
    risk_level: RiskLevel               # 상/중/하
    risk_factors: list[RiskFactor]       # 위험요소 목록

    # 금액 요약
    total_assumed_amount: int            # 인수해야 할 총 금액

    # 분석 근거
    analysis_reasoning: str             # AI의 분석 근거 설명
    confidence_score: float             # 분석 신뢰도 (0~1)
    warnings: list[str]                 # 주의사항

@dataclass
class ExtinguishmentBasis:
    """말소기준권리"""
    right_type: str                     # 권리 유형
    registration_date: date             # 설정일자
    right_holder: str                   # 권리자
    basis_reason: str                   # 판단 근거

@dataclass
class AnalyzedRight:
    """분석된 개별 권리"""
    order: int                          # 순위번호
    right_type: str                     # 권리 유형
    registration_date: date             # 설정일자
    right_holder: str                   # 권리자
    amount: int | None                  # 금액
    status: str                         # "인수" | "소멸" | "확인필요"
    analysis_note: str                  # 분석 설명

@dataclass
class TenantAnalysis:
    """임차인 분석"""
    tenant_name: str                    # 임차인명
    deposit: int                        # 보증금
    monthly_rent: int                   # 월세
    move_in_date: date | None           # 전입일
    has_opposition_right: bool          # 대항력 유무
    has_priority_repayment: bool        # 우선변제권 유무
    expected_dividend: int              # 예상 배당액
    eviction_difficulty: str            # 명도 난이도 (상/중/하)
    analysis_note: str                  # 분석 설명

class RiskLevel(str, Enum):
    HIGH = "상"
    MEDIUM = "중"
    LOW = "하"

@dataclass
class RiskFactor:
    """위험 요소"""
    category: str                       # 위험 카테고리
    description: str                    # 상세 설명
    severity: RiskLevel                 # 심각도
    recommendation: str                 # 대응 방안
```

---

## 5. 분석 로직 흐름

```
1. 등기부등본 데이터 수신 (PRD-01 파싱 결과)
       │
2. 갑구/을구 권리사항 시간순 정렬
       │
3. 말소기준권리 판단
   ├─ 근저당권 설정일 확인
   ├─ 전세권 설정일 확인
   ├─ 가압류 설정일 확인
   └─ 담보가등기 설정일 확인
       │
4. 각 권리별 인수/소멸 판단
   ├─ 선순위 권리 → 인수
   └─ 후순위 권리 → 소멸
       │
5. 임차인 분석 (매각물건명세서 연동)
   ├─ 대항력 유무 판단
   ├─ 우선변제권 판단
   └─ 배당 예측
       │
6. 특수 권리 분석 (가처분, 유치권 등)
       │
7. 위험도 종합 평가
       │
8. 분석 리포트 생성
```

---

## 6. AI 에이전트 설계

### 6.1 Claude 활용 포인트
- **비정형 텍스트 해석**: 등기부등본의 복잡한 문구 해석
- **법률 판단 보조**: 권리의 인수/소멸 판단 근거 생성
- **위험도 평가**: 종합적인 위험도 판단 및 설명 생성
- **쉬운 용어 변환**: 법률 용어를 일반인이 이해할 수 있는 표현으로 변환

### 6.2 프롬프트 설계 방향
- 부동산 경매 권리분석 전문가 페르소나 설정
- 대한민국 민사집행법 기반 분석 기준 명시
- 구조화된 JSON 출력 강제
- 불확실한 판단에 대한 경고 메시지 생성

---

## 7. 비기능 요구사항

- **정확도**: 말소기준권리 판단 정확도 90% 이상 (최종적으로 사용자 확인 필수)
- **응답 시간**: 권리분석 결과 30초 이내 반환
- **면책**: AI 분석 결과는 참고용이며, 최종 판단은 전문가 자문 권고 문구 표시

---

## 8. 추후 상세화 필요 사항
- [ ] 말소기준권리 판단 세부 알고리즘 설계
- [ ] 배당 예측 로직 상세화
- [ ] 특수 권리(유치권, 법정지상권 등) 판단 기준 상세화
- [ ] Claude 프롬프트 템플릿 상세 작성
- [ ] 권리분석 결과 검증 체크리스트 작성
- [ ] 법률 변경 시 업데이트 전략 수립
